beta.root <- 1.302
g <- gen.thread(n=100, alpha.root=1, alpha.c=1, beta.root=10)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
source('~/Documentos/PhD/src/Thread growth models/thread_generator.r')
alpha.root <- 0.734
alpha.c <- 0.683
beta.root <- 1.302
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
# Wikipedia
alpha.root <- 0.884
alpha.c <- -1.684
beta.root <- 0.794
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
# Wikipedia
alpha.root <- 0.884
alpha.c <- -1.684
beta.root <- 0.794
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
# Wikipedia
alpha.root <- 0.884
alpha.c <- -1.684
beta.root <- 0.794
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
# Wikipedia
alpha.root <- 0.884
alpha.c <- -1.684
beta.root <- 0.794
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
# Wikipedia
alpha.root <- 0.884
alpha.c <- -1.684
beta.root <- 0.794
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
# Wikipedia
alpha.root <- 0.884
alpha.c <- -1.684
beta.root <- 0.794
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
# Wikipedia
alpha.root <- 0.884
alpha.c <- -1.684
beta.root <- 0.794
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
# Wikipedia
alpha.root <- 0.884
alpha.c <- -1.684
beta.root <- 0.794
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
# Wikipedia
alpha.root <- 0.884
alpha.c <- -1.684
beta.root <- 0.794
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
# Wikipedia
alpha.root <- 0.884
alpha.c <- -1.684
beta.root <- 0.794
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
# Wikipedia
alpha.root <- 0.884
alpha.c <- -1.684
beta.root <- 0.794
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
# Wikipedia
alpha.root <- 0.884
alpha.c <- -1.684
beta.root <- 0.794
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
alpha.root <- 0.734
alpha.c <- 0.683
beta.root <- 1.302
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
par(mfrow=c(1,1))
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
degree(g)
which(degree(g, mode='out')==0)
par(mfrow=c(1,1))
root = which(degree(g, mode='out')==0)
V(g)$color <- 'black'
V(g)$color[root] <- 'red'
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6, vertex.color='black')
par(mfrow=c(1,1))
root = which(degree(g, mode='out')==0)
V(g)$color <- 'black'
V(g)$color[root] <- 'red'
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=2, edge.arrow.size=0.6)
par(mfrow=c(1,1))
root = which(degree(g, mode='out')==0)
V(g)$color <- 'black'
V(g)$color[root] <- 'red'
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=1, edge.arrow.size=0.6)
par(mfrow=c(1,1))
root = which(degree(g, mode='out')==0)
V(g)$color <- 'black'
V(g)$color[root] <- 'red'
V(g)$size <- 1
V(g)$size[root] <- 3
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, vertex.size=1, edge.arrow.size=0.6)
par(mfrow=c(1,1))
root = which(degree(g, mode='out')==0)
V(g)$color <- 'black'
V(g)$color[root] <- 'red'
V(g)$size <- 1
V(g)$size[root] <- 3
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, edge.arrow.size=0.6)
par(mfrow=c(2,2))
for (i in 1:4){
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
root = which(degree(g, mode='out')==0)
V(g)$color <- 'black'
V(g)$color[root] <- 'red'
V(g)$size <- 1
V(g)$size[root] <- 3
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, edge.arrow.size=0.6)
}
alpha.root <- 0.665
alpha.c <- -0.116
beta.root <- 0.781
par(mfrow=c(2,2))
for (i in 1:4){
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
root = which(degree(g, mode='out')==0)
V(g)$color <- 'black'
V(g)$color[root] <- 'red'
V(g)$size <- 1
V(g)$size[root] <- 3
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, edge.arrow.size=0.6)
}
alpha.root <- 0.856
alpha.c <- 0.196
beta.root <- 1.588
par(mfrow=c(2,2))
for (i in 1:4){
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
root = which(degree(g, mode='out')==0)
V(g)$color <- 'black'
V(g)$color[root] <- 'red'
V(g)$size <- 1
V(g)$size[root] <- 3
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, edge.arrow.size=0.6)
}
# Wikipedia
alpha.root <- 0.884
alpha.c <- -1.684
beta.root <- 0.794
par(mfrow=c(2,2))
for (i in 1:4){
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
root = which(degree(g, mode='out')==0)
V(g)$color <- 'black'
V(g)$color[root] <- 'red'
V(g)$size <- 1
V(g)$size[root] <- 3
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, edge.arrow.size=0.6)
}
debugSource('~/Documentos/PhD/src/Thread growth models/thread_generator.r')
(betas*popularities)^alphas
betas
popularities
alphas
(betas[1]*popularities[1])^alpha[1]
(betas[i]*popularities[i])^alpha[i]
i <- 1
(betas[i]*popularities[i])^alpha[i]
i <- 2
(betas[i]*popularities[i])^alpha[i]
alpha
alphas
(betas[i]*popularities[i])^alphas[i]
i <- 1
(betas[i]*popularities[i])^alphas[i]
(betas*popularities)^alphas
i <- 1
(betas[i]*popularities[i])^alphas[i]
i <- 2
(betas[i]*popularities[i])^alphas[i]
source('~/Documentos/PhD/src/Thread growth models/thread_generator.r')
?do.call
gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
gen.thread(n=10, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
rep(gen.thread(n=10, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root),2)
res <- rep(gen.thread(n=10, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root),2)
res
res[1]
res[2]
res
res <- rep(do.call(gen.thread(n=10, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)),2)
source('~/Documentos/PhD/src/Thread growth models/thread_generator.r')
res <- rep(do.call(gen.thread,n=10, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root), 2)
?rep
lapply(sum, é)
lapply(sum, 2)
lapply(1:3, sum, 2)
lapply(1:3, sum)
lapply(1:3, sum, 2)
lapply(sum, 2)
lapply(1:3sum, 2)
lapply(1:3, sum, 2)
lapply(1:3, exp, 2)
lapply(exp, 2)
tapply(exp, 2)
sapply(exp, 2)
trees <- replicate(gen.thread, n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
trees <- replicate(2, gen.thread, n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
gen.thread
trees <- replicate(2,  gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root))
trees
trees <- replicate(2,  gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root), simplify = FALSE)
trees
trees <- replicate(4,  gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root), simplify = FALSE)
par(mfrow=c(2,2))
for (i in 1:length(trees)){
g <- gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root)
root = which(degree(g, mode='out')==0)
V(g)$color <- 'black'
V(g)$color[root] <- 'red'
V(g)$size <- 1
V(g)$size[root] <- 3
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, edge.arrow.size=0.6)
}
trees <- replicate(4,  gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root), simplify = FALSE)
par(mfrow=c(2,2))
for (i in 1:length(trees)){
g <- trees[[i]]
root = which(degree(g, mode='out')==0)
V(g)$color <- 'black'
V(g)$color[root] <- 'red'
V(g)$size <- 1
V(g)$size[root] <- 3
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, edge.arrow.size=0.6)
}
trees <- replicate(4,  gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root), simplify = FALSE)
par(mfrow=c(2,2))
for (i in 1:length(trees)){
g <- trees[[i]]
root = which(degree(g, mode='out')==0)
V(g)$color <- 'black'
V(g)$color[root] <- 'red'
V(g)$size <- 1
V(g)$size[root] <- 3
g.un <- as.undirected(g)
la = layout_with_fr(g.un)
plot(g.un, layout = la, vertex.label = NA, edge.arrow.size=0.6)
}
n <- 100
# Slashdot:
alpha.root <- 0.734
alpha.c <- 0.683
beta.root <- 1.302
trees <- replicate(n,  gen.thread(n=100, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root), simplify = FALSE)
save(trees, file='trees.Rda')
g
?neighbors()
parents <- neighbors(g, V(g)[-1], mode='out')
parents
V(g)[-1]
neighbors(g, V(g)[-1], mode='out')
neighbors(g, 1:10, mode='out')
neighbors(g, 1:10, mode='in')
E(g)
plot.tree(g)
neighbors(g, 1:10, mode='in')
?neighbors
neighbors(g, 1, mode='in')
neighbors(g, 1, mode='out')
neighbors(g, 2, mode='out')
neighbors(g, 3, mode='out')
neighbors(g, 30, mode='out')
neighbors(g, c(1,30), mode='out')
neighbors(g, c(30), mode='out')
?get.edgelist
get.edgelist(g)
parents <- get.edgelist(g)[,2]
parents
table(parents)
table(parents[1:sizes])
table(parents[1:size])
size <- vcount(g)
table(parents[1:size])
table(parents[1:(size-1)])
table(parents[1:(size-2)])
table(parents[1:(size-3)])
table(parents[1:(size-4)])
table(parents[1:(size-40)])
table(parents)
?tabulate
kl
?tabulate
tabulate(1:10)
table(parents[1:10])
tabulate(parents[1:10], nbins=length(parents))
tabulate(parents, nbins=length(parents))
tabulate(parents[1:length(parents)], nbins=length(parents))
# Compute degrees only once for all trees (3-dimensional array: node, time, tree)
load('trees.Rda')
length(trees)
for (i in 1:length(trees)){
parents <- get.edgelist(g)[,2]
size <- length(parents)+1
sapply(2:size, function(t) tabulate(parents[1:t], nbins=size))
}
for (i in 1:length(trees)){
parents <- get.edgelist(trees[[i]])[,2]
size <- length(parents)+1
sapply(2:size, function(t) tabulate(parents[1:t], nbins=size))
}
for (i in 1:length(trees)){
parents <- get.edgelist(trees[[i]])[,2]
size <- length(parents)+1
r <- sapply(2:size, function(t) tabulate(parents[1:t], nbins=size))
cat(r)
cat('\n')
}
r <- sapply(2:size, function(t) tabulate(parents[1:t], nbins=size))
parents
r <- sapply(2:size, function(t) tabulate(parents[1:t], nbins=size))
r
size
# Generate a synthetic dataset of trees
n <- 100
# Slashdot:
alpha.root <- 0.734
alpha.c <- 0.683
beta.root <- 1.302
trees <- replicate(n,  gen.thread(n=20, alpha.root=alpha.root, alpha.c=alpha.c, beta.root=beta.root), simplify = FALSE)
save(trees, file='trees.Rda')
load('trees.Rda')
for (i in 1:length(trees)){
parents <- get.edgelist(trees[[i]])[,2]
size <- length(parents)+1
r <- sapply(2:size, function(t) tabulate(parents[1:t], nbins=size))
cat(r)
cat('\n')
}
r
parents
r <- t(sapply(2:size, function(t) tabulate(parents[1:t], nbins=size)))
r
all.degrees <- list()
for (i in 1:length(trees)){
parents <- get.edgelist(trees[[i]])[,2]
size <- length(parents)+1
all.degrees[i] <- t(sapply(2:size, function(t) tabulate(parents[1:t], nbins=size)))
}
warnings()
all.degrees
all.degrees <- list()
for (i in 1:length(trees)){
parents <- get.edgelist(trees[[i]])[,2]
size <- length(parents)+1
all.degrees[[i]] <- t(sapply(2:size, function(t) tabulate(parents[1:t], nbins=size)))
}
all.degrees
length(all.degrees)
load('trees.Rda')
all.degrees <- list()
for (i in 1:length(trees)){
parents <- get.edgelist(trees[[i]])[,2]
size <- length(parents)+1
all.degrees[[i]] <- t(sapply(1:size, function(t) tabulate(parents[1:t], nbins=size)))
}
all.degrees
lags
b <- rep(0,t-1)
b[1] <- beta
lags <- (t-1):1
b
lags
b <- rep(0,t)
b
t <- 2
b <- rep(0,t)
b
